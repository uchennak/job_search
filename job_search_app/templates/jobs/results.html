{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Job Results</title>
    <link rel="stylesheet" href="/static/css/styles.css">
 
</head>
<body>
    <h1>Job Search Results</h1>
    
    {% if error %}
        <div class="error">
            <strong>Error:</strong> {{ error }}
        </div>
    {% endif %}
    
    {% if message %}
        <div class="message">
            {{ message }}
        </div>
    {% endif %}
    
    {% if query or location %}
        <div class="search-info">
            {% if query %}
                <p>üîç <strong>Search Query:</strong> {{ query }}</p>
            {% endif %}
            {% if location %}
                <p>üìç <strong>Location:</strong> {{ location }}</p>
            {% endif %}
            {% if exclude %}
                <p>üö´ <strong>Excluding:</strong> {{ exclude }}</p>
            {% endif %}
            {% if search_scope == 'title_only' %}
                <p>üìù <strong>Filter:</strong> Searching in titles only</p>
            {% elif search_scope == 'description_only' %}
                <p>üìù <strong>Filter:</strong> Searching in descriptions only</p>
            {% endif %}
        </div>
    {% endif %}
    
    {% if jobs %}
        <p class="results-count">
            Showing {{ jobs.start_index }}-{{ jobs.end_index }} of {{ jobs.paginator.count }} jobs
        </p>
        
        <table>
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Job Title</th>
                    <th>Location</th>
                    <th>Experience</th>
                    <th>Apply</th>
                </tr>
            </thead>
            <tbody>
                {% for job in jobs %}
                <tr>
                    <td class="company">{{ job.employer_name|default:"N/A" }}</td>
                    <td class="job-title">{{ job.job_title|truncatechars:60 }}</td>
                    <td class="location">
                        {% if job.job_city and job.job_state %}
                            {{ job.job_city }}, {{ job.job_state }}
                        {% elif job.job_location %}
                            {{ job.job_location }}
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>
                        <span class="experience">
                            {{ job.experience_required|default:"Not specified" }}
                        </span>
                    </td>
                    <td>
                        <a href="{{ job.job_apply_link }}" target="_blank" class="apply-btn">
                            Apply Now ‚Üí
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- Pagination Controls -->
        {% if jobs.has_other_pages %}
        <div class="pagination">
            {% if jobs.has_previous %}
                <a href="?q={{ query }}&location={{ location }}&exclude={{ exclude }}&title_only={{ title_only }}&description_only={{ description_only }}&limit={{ limit }}&per_page={{ per_page }}&page=1">
                    &laquo; First
                </a>
                <a href="?q={{ query }}&location={{ location }}&exclude={{ exclude }}&title_only={{ title_only }}&description_only={{ description_only }}&limit={{ limit }}&per_page={{ per_page }}&page={{ jobs.previous_page_number }}">
                    &lsaquo; Previous
                </a>
            {% endif %}
            
            <span class="current">
                Page {{ jobs.number }} of {{ jobs.paginator.num_pages }}
            </span>
            
            {% if jobs.has_next %}
                <a href="?q={{ query }}&location={{ location }}&exclude={{ exclude }}&title_only={{ title_only }}&description_only={{ description_only }}&limit={{ limit }}&per_page={{ per_page }}&page={{ jobs.next_page_number }}">
                    Next &rsaquo;
                </a>
                <a href="?q={{ query }}&location={{ location }}&exclude={{ exclude }}&title_only={{ title_only }}&description_only={{ description_only }}&limit={{ limit }}&per_page={{ per_page }}&page={{ jobs.paginator.num_pages }}">
                    Last &raquo;
                </a>
            {% endif %}
        </div>
        {% endif %}
        
    {% else %}
        <div class="no-results">
            <h2>üòï No jobs found</h2>
            <p>Try adjusting your search criteria or location.</p>
        </div>
    {% endif %}
    
    <a href="{% url 'search' %}" class="back-link">‚Üê Back to Search</a>
</body>
</html>